"use strict";angular.module("sbAdminApp").controller("homeCtrl",function($scope,$http,api,$window,$cookieStore){function reset(){$scope.users=[],$scope.bankUsers=[],$scope.showChart=!1}function generatePieChart(data){var shortCodesgraphData=[];$scope.showChart=!0;for(var i=data.length-1;i>=0;i--){var tempArr=[],temoObj={};tempArr.push({v:data[i].merchantname},{v:data[i].count}),temoObj.c=tempArr,shortCodesgraphData.push(temoObj)}$scope.myChartObject.data={cols:[{id:"t",label:"MerchantName",type:"string"},{id:"s",label:"count",type:"number"}],rows:shortCodesgraphData}}$window.scrollTo(0,0),$scope.closeAlert=function(){$scope.alert=!1},$scope.categories=["travel","purchases","credit-transaction","debit-transaction"],$scope.getMerchants=function(){$scope.merchantName=[],$scope.showLoader1=!0,reset(),$scope.selected=!1,api.get("get-merchants",!1,!1,{category:$scope.category},function(err,response){err?$scope.alert=response.message:($scope.showLoader1=!1,$scope.merchantName=response.merchantname)})},$scope.getUserCount=function(merchant){for(var checkboxes=document.getElementsByName("merchantCheckbox"),merchants=[],i=0;i<checkboxes.length;i++)if(checkboxes[i].checked){var value=checkboxes[i].value;merchants.push(value)}if(0===merchants.length)return void($scope.alert="Please Choose one or more merchant");void 0===$scope.start||void 0===$scope.end?$scope.alert=" Range field is undefined ":void 0===$scope.dt1&&($scope.alert=" From Field Is empty ");var dt1=$scope.dt1.getTime(),dt2=$scope.dt2.getTime();$scope.showLoader2=!0,reset(),api.post("get-user-count",!1,!1,{category:$scope.category,merchant:merchants,range:[$scope.start,$scope.end],date:[dt1,dt2]},function(err,response){err?$scope.alert=response.message:"travel"===$scope.category||"purchases"===$scope.category?($scope.users=response.result,$scope.showLoader2=!1):("credit-transaction"===$scope.category||"debit-transaction"===$scope.category)&&($scope.bankUsers=response.result,$scope.showLoader2=!1),generatePieChart(response.result)})},$scope.dt2=new Date,$scope.dateOptions={formatYear:"yy",maxDate:new Date,startingDay:1},$scope.open1=function(){$scope.popup1.opened=!0},$scope.open2=function(){$scope.popup2.opened=!0},$scope.altInputFormats=["M!/d!/yyyy"],$scope.popup1={opened:!1},$scope.popup2={opened:!1},$scope.myChartObject={},$scope.myChartObject.type="PieChart"});