"use strict";angular.module("sbAdminApp").controller("userDetailCtrl",function($scope,$http,$stateParams,api,DTOptionsBuilder,DTColumnBuilder,$filter){var id=$stateParams.id,url=api.addr();$scope.selectAll=!1;$scope.getUser=function(){api.get("get-user",id,!1,!1,function(err,response){err||response.error?$scope.alerts=[{msg:response.userMessage||"Server error! Are you connected to the internet?.",type:"error"}]:($scope.userData=response.userdata,$scope.userUnprocCode=response.code)})},$scope.getUser(),api.get("get-sms-count-status",id,!1,!1,function(err,response){if(err||response.error)$scope.alerts=[{msg:response.userMessage||"Server error! Are you connected to the internet?.",type:"error"}];else for(var i=0;i<response.length;i++)0===response[i].status?$scope.unproCount=response[i].count:3===response[i].status&&($scope.proCount=response[i].count)}),$scope.dtOptions=DTOptionsBuilder.newOptions().withOption("ajax",{url:url+"get-user-sms/"+id+"/0",type:"GET"}).withOption("processing",!0).withOption("serverSide",!0).withLanguage({sSearch:"Search Shortcode :",oPaginate:{sNext:"»",sPrevious:"«"}}),$scope.dtColumns=[DTColumnBuilder.newColumn("address").withTitle("address"),DTColumnBuilder.newColumn("text").withTitle("text "),DTColumnBuilder.newColumn("time").withTitle("time ").renderWith(function(data,type,full){return $filter("date")(data,"d MMM y, h:mm a")}),DTColumnBuilder.newColumn("status").withTitle("status ").renderWith(function(data,type,full){return 0===data?data=" unprocessed":3===data?data=" processed":data})],$scope.dtOptions1=DTOptionsBuilder.newOptions().withOption("ajax",{url:url+"get-user-sms/"+id+"/3",type:"GET"}).withOption("processing",!0).withOption("serverSide",!0),$scope.dtColumns1=[DTColumnBuilder.newColumn("address").withTitle("address"),DTColumnBuilder.newColumn("text").withTitle("text "),DTColumnBuilder.newColumn("time").withTitle("time ").renderWith(function(data,type,full){return $filter("date")(data,"d MMM y, h:mm a")}),DTColumnBuilder.newColumn("status").withTitle("status ").renderWith(function(data,type,full){return 0===data?data=" unprocessed":3===data?data=" processed":data})],$scope.blacklist=function(){$scope.addresses=[];for(var checkboxes=document.getElementsByName("blacklist"),i=0;i<checkboxes.length;i++)if(checkboxes[i].checked){var value=checkboxes[i].value;$scope.addresses.push(value)}api.put("blacklist",!1,!1,{address:$scope.addresses},function(err,response){err||response.error?$scope.alerts=[{msg:response.userMessage||"Server error! Are you connected to the internet?.",type:"error"}]:($scope.alerts=[{msg:response.message||"Server error! Are you connected to the internet?.",type:"success"}],$scope.getUser())})},$scope.toggle=function(){for(var checkboxes=document.getElementsByName("blacklist"),i=0;i<checkboxes.length;i++)checkboxes[i].checked=$scope.toggleSelection},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)}});